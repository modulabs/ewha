# [실습] n8n을 활용한 워크플로우 자동화

- **주관:** AI 전문 강사 조해창
- **학습 목표:** 코딩 없이(No-code) 다양한 앱과 AI를 연결하여 나만의 자동화 워크플로우를 구축하는 방법을 마스터합니다.

## 주요 내용

### 1. n8n 소개 및 핵심 개념(노드, 워크플로우, 트리거)

*   **n8n 재확인:** 이전 세션에서 다룬 n8n의 기본 개념과 필요성을 다시 한번 상기.
*   **n8n 설치 및 실행 (실습):**
    *   **가장 쉬운 방법:** n8n Desktop App 설치 및 실행.
    *   **대안:** Docker를 이용한 설치 (`docker run -it --rm --name n8n -p 5678:5678 n8n/n8n`).
    *   n8n 웹 UI 접속 (기본: `http://localhost:5678`).
*   **워크플로우 빌더 인터페이스 탐색:**
    *   **캔버스(Canvas):** 노드를 추가하고 연결하는 작업 공간.
    *   **노드 패널:** 사용 가능한 노드 검색 및 추가.
    *   **속성 패널:** 선택된 노드의 설정 및 옵션 조정.
    *   **실행 결과 패널:** 워크플로우 실행 결과 및 데이터 흐름 확인.
*   **핵심 개념 실습:**
    *   **트리거 노드 추가:** `Manual Trigger` 노드를 추가하여 워크플로우를 수동으로 시작하는 방법 시연.
    *   **일반 노드 추가:** `Set` 노드를 추가하여 데이터를 생성하거나 수정하는 방법 시연.
    *   **노드 연결:** 노드들을 드래그 앤 드롭으로 연결하여 데이터 흐름 만들기.
    *   **워크플로우 실행:** `Execute Workflow` 버튼을 눌러 워크플로우 실행 및 결과 확인.

### 2. [기초] 구글 시트와 슬랙을 연동하여 알림 봇 만들기

*   **구현 목표:** Google Sheets에 새로운 행이 추가될 때마다 Slack 채널로 알림 메시지를 보내는 자동화 봇 구축.
*   **워크플로우 설계:**
    *   **트리거:** `Google Sheets Trigger` 노드 (새로운 행 추가 시).
    *   **데이터 추출:** `Google Sheets` 노드에서 추가된 행의 데이터 추출.
    *   **메시지 구성:** `Set` 노드 또는 `Code` 노드를 사용하여 Slack 메시지 내용 구성. (예: "새로운 데이터가 추가되었습니다: [데이터 내용]")
    *   **알림 전송:** `Slack` 노드 (특정 채널로 메시지 전송).
*   **단계별 실습:**
    1.  **Google Sheets 준비:** 알림을 받을 Google 스프레드시트 생성 및 샘플 데이터 입력.
    2.  **Google Sheets Trigger 노드 설정:**
        *   Google 계정 연동.
        *   대상 스프레드시트 및 시트 선택.
        *   트리거 이벤트: "New Row".
    3.  **Set 노드 추가:** Google Sheets에서 넘어온 데이터를 Slack 메시지에 맞게 가공. (예: `{{ $json.columnName }}` 문법 사용)
    4.  **Slack 노드 추가:**
        *   Slack 워크스페이스 연동.
        *   메시지를 보낼 채널 선택.
        *   메시지 텍스트에 `Set` 노드에서 가공한 데이터 삽입.
    5.  **워크플로우 활성화:** `Active` 토글을 켜서 워크플로우를 활성화.
    6.  **테스트:** Google Sheets에 새로운 행을 추가하여 Slack 알림이 오는지 확인.
*   **팁:** Slack 메시지에 이미지, 버튼 등 추가하는 방법 간략 소개.

### 3. [심화] 이메일 내용을 분석하여 AI가 자동으로 답변 초안을 작성하고 슬랙으로 보내는 워크플로우 구축하기

*   **구현 목표:** 특정 이메일 계정으로 문의 메일이 오면, n8n이 이메일 내용을 읽고 Claude AI를 통해 답변 초안을 생성한 후, 이를 Slack으로 보내 담당자가 검토하고 발송할 수 있도록 하는 워크플로우.
*   **워크플로우 설계:**
    *   **트리거:** `Gmail Trigger` 노드 (새 이메일 수신 시).
    *   **이메일 내용 추출:** `Gmail` 노드에서 이메일 본문, 발신자, 제목 등 추출.
    *   **AI 답변 생성:** `HTTP Request` 노드 또는 `Code` 노드를 사용하여 Claude API 호출.
        *   프롬프트 구성: "다음 이메일 내용에 대해 친절하고 전문적인 답변 초안을 작성해줘: [이메일 본문]".
        *   Claude API 응답 파싱.
    *   **Slack 알림:** `Slack` 노드 (생성된 답변 초안과 원본 이메일 정보 전송).
*   **단계별 실습:**
    1.  **Gmail Trigger 노드 설정:**
        *   Gmail 계정 연동.
        *   트리거 이벤트: "New Email".
        *   필터 설정 (예: 특정 제목, 라벨).
    2.  **HTTP Request 노드 (Claude API 호출):**
        *   메서드: POST, URL: Claude API 엔드포인트.
        *   헤더: `Authorization: Bearer YOUR_CLAUDE_API_KEY`, `Content-Type: application/json`.
        *   바디: Claude API 요청 형식에 맞춰 JSON 데이터 구성 (프롬프트 포함).
        *   응답 처리: Claude의 응답에서 답변 텍스트 추출.
    3.  **Slack 노드 추가:**
        *   Slack 워크스페이스 연동.
        *   메시지 내용: 원본 이메일 정보 + Claude가 생성한 답변 초안.
        *   (선택 사항) 버튼 추가: "답변 검토하기" 버튼을 눌러 특정 웹 페이지로 이동하도록 설정.
    4.  **워크플로우 활성화 및 테스트:** 실제 테스트 이메일을 보내 워크플로우가 정상 작동하는지 확인.
*   **고려 사항:**
    *   **API 키 보안:** n8n 자격 증명(Credentials) 기능을 사용하여 API 키를 안전하게 관리.
    *   **프롬프트 엔지니어링:** Claude가 더 좋은 답변을 생성하도록 프롬프트를 정교하게 다듬는 방법.
    *   **에러 핸들링:** API 호출 실패 시 알림 또는 재시도 로직 추가.
*   **활용 사례:** 고객 지원 자동화, 내부 문의 처리, 뉴스 요약 및 공유 등.